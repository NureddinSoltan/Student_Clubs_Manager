<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Events Page</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    .table-hover tbody tr:hover {
      background-color: #f5f5f5;
    }

    .clickable-row a {
      display: block;
      color: inherit;
      text-decoration: none;
    }

    #actionType.accept {
      color: green;
    }

    #actionType.reject {
      color: red;
    }
  </style>
</head>

<body>
  <div class="container mt-5">
    <div class="row text-center">
      <div class="col-md-3 mb-3">
        <div class="card bg-primary text-white">
          <div class="card-body">
            <h5 class="card-title">Total Requests</h5>
            <p class="card-text" id="totalRequests">{{total_requests}}</p>
          </div>
        </div>
      </div>
      <div class="col-md-3 mb-3">
        <div class="card bg-success text-white">
          <div class="card-body">
            <h5 class="card-title">Accepted</h5>
            <p class="card-text" id="acceptedRequests">{{accepted}}</p>
          </div>
        </div>
      </div>
      <div class="col-md-3 mb-3">
        <div class="card bg-danger text-white">
          <div class="card-body">
            <h5 class="card-title">Rejected</h5>
            <p class="card-text" id="rejectedRequests">{{rejected}}</p>
          </div>
        </div>
      </div>
      <div class="col-md-3 mb-3">
        <div class="card bg-warning text-white">
          <div class="card-body">
            <h5 class="card-title">Waiting</h5>
            <p class="card-text" id="waitingRequests">{{waiting}}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Filter Section -->
    <ul class="nav nav-tabs">
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false"
          id="filterByRequestTime">Filter by Request <i class="fa-solid fa-code-pull-request"></i></a>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item" href="#" onclick="updateFilter('filterByRequestTime', 'Event Post')">Event Post</a></li>
          <li><a class="dropdown-item" href="#" onclick="updateFilter('filterByRequestTime', 'Activity Form')">Activity Form</a></li>
          <li><a class="dropdown-item" href="#" onclick="updateFilter('filterByRequestTime', 'Edit Event Post')">Edit Event Post</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false"
          id="filterByStatus">Filter by Status <i class="fas fa-clipboard-check"></i></a>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item" href="#" onclick="updateFilter('filterByStatus', 'Waiting')">Waiting</a></li>
          <li><a class="dropdown-item" href="#" onclick="updateFilter('filterByStatus', 'Accepted')">Accepted</a></li>
          <li><a class="dropdown-item" href="#" onclick="updateFilter('filterByStatus', 'Rejected')">Rejected</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false"
          id="filterByDate">Filter by Time <i class="fas fa-calendar-alt"></i></a>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item" href="#" onclick="updateFilter('filterByDate', 'Oldest')">Oldest</a></li>
          <li><a class="dropdown-item" href="#" onclick="updateFilter('filterByDate', 'New')">New</a></li>
        </ul>
      </li>
      <button class="btn btn-primary m-1">Apply Filters</button>
    </ul>

    <!-- Modal -->
    <div class="modal fade" id="confirmationModal" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalLabel">Confirmation</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            Are you sure you want to <span id="actionType"></span> this request?
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" id="confirmBtn">Yes, proceed</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Table Section -->
    <div class="table-responsive">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Request Type</th>
            <th>Date</th>
            <th>Title</th>
            <th>Status</th>
            <th>Club</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for object in events %}
          <tr class="clickable-row">
            <td><a href="#">Event Post</a></td>
            <td><a href="#">{{object.date}}</a></td>
            <td><a href="#">{{object.title}}</a></td>
            <td><a href="#">{{object.status}}</a></td>
            <td><a href="#">{{object.club.title}}</a></td>
            <td>
              <button class="btn btn-success btn-sm mb-1" data-bs-toggle="modal" data-bs-target="#confirmationModal"
                onclick="setActionType('accept')">Accept</button>
              <button class="btn btn-danger btn-sm mb-1" data-bs-toggle="modal" data-bs-target="#confirmationModal"
                onclick="setActionType('reject')">Reject</button>
            </td>
          </tr>
          {% endfor %}

          {% for object in activity_form %}
          <tr class="clickable-row">
            <td><a href="#">Activity Form</a></td>
            <td><a href="#">{{object.date}}</a></td>
            <td><a href="#">{{object.title}}</a></td>
            <td><a href="#">{{object.status}}</a></td>
            <td><a href="#">{{object.club.title}}</a></td>
            <td>
              <button class="btn btn-success btn-sm mb-1" data-bs-toggle="modal" data-bs-target="#confirmationModal"
                onclick="setActionType('accept')">Accept</button>
              <button class="btn btn-danger btn-sm mb-1" data-bs-toggle="modal" data-bs-target="#confirmationModal"
                onclick="setActionType('reject')">Reject</button>
            </td>
          </tr>
          {% endfor %}

          {% for object in edit_event_post %}
          <tr class="clickable-row">
            <td><a href="#">Edit Event Post</a></td>
            <td><a href="#">{{object.date}}</a></td>
            <td><a href="#">{{object.title}}</a></td>
            <td><a href="#">{{object.status}}</a></td>
            <td><a href="#">{{object.club.title}}</a></td>
            <td>
              <button class="btn btn-success btn-sm mb-1" data-bs-toggle="modal" data-bs-target="#confirmationModal"
                onclick="setActionType('accept')">Accept</button>
              <button class="btn btn-danger btn-sm mb-1" data-bs-toggle="modal" data-bs-target="#confirmationModal"
                onclick="setActionType('reject')">Reject</button>
            </td>
          </tr>
          {% endfor %}
          <!-- Additional rows as needed -->
      </table>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    function updateFilter(dropdownId, selectedOption) {
      document.getElementById(dropdownId).innerText = selectedOption + ' ';
      const icon = document.createElement('i');
      switch (dropdownId) {
        case 'filterByRequestTime':
          icon.className = 'fas fa-clock';
          break;
        case 'filterByStatus':
          icon.className = 'fas fa-clipboard-check';
          break;
        case 'filterByDate':
          icon.className = 'fas fa-calendar-alt';
          break;
      }
      document.getElementById(dropdownId).appendChild(icon);
    }

    function setActionType(action) {
      const modalLabel = document.getElementById('actionType');
      modalLabel.textContent = action;
      modalLabel.className = action; // Add the class for styling
      document.getElementById('confirmBtn').onclick = function () {
        console.log(action === 'accept' ? 'Accepted' : 'Rejected');
        var modalElement = document.getElementById('confirmationModal');
        var modalInstance = bootstrap.Modal.getInstance(modalElement);
        modalInstance.hide();
      };
    }
  </script>
</body>

</html>